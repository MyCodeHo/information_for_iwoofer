# 项目结构

我理解你想学习如何构建一个类似 iWoofer Pro 的 iOS 音频 DSP控制应用。我可以帮你设计一个原创的、符合行业最佳实践的软件架构，但需要明确：我们要创建的是一个功能相似但独立开发的应用**，而不是复制现有软件。

暂时没有创建Tests，Packages，Documentation目录
Resources目录下的文件也未具体创建
Views目录下还没有细分子目录
UseCases和Repositories目录下的文件也未具体创建

## 🏗️ 推荐的项目架构（MVVM + Clean Architecture）

iWooferPro/
├── iWooferPro.xcodeproj/
├── iWooferPro/

### │   ├── App/

│   │   ├── iWooferProApp.swift                 # App 入口
│   │   ├── AppDelegate.swift                   # 生命周期管理
│   │   └── SceneDelegate.swift                 # 场景管理（如需要）
│   │

### │   ├── Core/

│   │   ├── Network/
│   │   │   └── Bluetooth/
│   │   │       ├── BluetoothManager.swift          # 蓝牙中心管理器
│   │   │       ├── BluetoothDevice.swift           # 蓝牙设备模型
│   │   │       ├── BluetoothScanner.swift          # 设备扫描服务
│   │   │       ├── BluetoothConnection.swift       # 连接管理
│   │   │       └── BluetoothProtocol.swift         # 通信协议定义
│   │   │

│   │   ├── DSP/

│   │   │   ├── DSPController.swift                 # DSP 控制核心
│   │   │   ├── DSPCommandBuilder.swift             # DSP 命令构建器
│   │   │   ├── DSPParameter.swift                  # DSP 参数模型
│   │   │   ├── DSPCommandParser.swift              # 命令解析器
│   │   │   └── Filters/
│   │   │       ├── EqualizerFilter.swift           # 均衡器滤波器
│   │   │       ├── CrossoverFilter.swift           # 分频器
│   │   │       ├── PhaseControl.swift              # 相位控制
│   │   │       └── GainControl.swift               # 增益控制
│   │   │
│   │   ├── Audio/
│   │   │   ├── AudioCaptureEngine.swift            # 音频采集引擎
│   │   │   ├── AudioAnalyzer.swift                 # 音频分析器
│   │   │   ├── FFTProcessor.swift                  # FFT 频谱分析
│   │   │   ├── SPLMeter.swift                      # 声压级测量
│   │   │   └── FrequencyResponseAnalyzer.swift     # 频率响应分析
│   │   │
│   │   ├── RoomCorrection/
│   │   │   ├── RoomCorrectionEngine.swift          # 房间校准引擎
│   │   │   ├── MeasurementSession.swift            # 测量会话
│   │   │   ├── RoomAcousticAnalyzer.swift          # 房间声学分析
│   │   │   ├── ParameterRecommender.swift          # 参数推荐算法
│   │   │   └── CompensationCalculator.swift        # 补偿计算
│   │   │
│   │   └── Storage/
│   │       ├── StorageManager.swift                # 存储管理器
│   │       ├── PresetRepository.swift              # 预设仓储
│   │       ├── ProfileRepository.swift             # 配置文件仓储
│   │       └── CacheManager.swift                  # 缓存管理
│   │

### │   ├── Domain/

│   │   ├── Models/
│   │   │   ├── Device/
│   │   │   │   ├── SubwooferDevice.swift           # 低音炮设备模型
│   │   │   │   ├── DeviceCapability.swift          # 设备能力
│   │   │   │   └── DeviceStatus.swift              # 设备状态
│   │   │   │
│   │   │   ├── Audio/
│   │   │   │   ├── AudioMeasurement.swift          # 音频测量数据
│   │   │   │   ├── FrequencyResponse.swift         # 频率响应
│   │   │   │   ├── RoomProfile.swift               # 房间档案
│   │   │   │   └── SPLData.swift                   # 声压级数据
│   │   │   │
│   │   │   ├── DSPSettings/
│   │   │   │   ├── EqualizerSettings.swift         # 均衡器设置
│   │   │   │   ├── CrossoverSettings.swift         # 分频设置
│   │   │   │   ├── PhaseSettings.swift             # 相位设置
│   │   │   │   ├── GainSettings.swift              # 增益设置
│   │   │   │   ├── LimiterSettings.swift           # 限制器设置
│   │   │   │   └── DynamicBassSettings.swift       # 动态低音设置
│   │   │   │
│   │   │   └── Preset/
│   │   │       ├── PresetProfile.swift             # 预设方案
│   │   │       ├── PresetCategory.swift            # 预设分类
│   │   │       └── UserPreset.swift                # 用户自定义预设
│   │   │
│   │   ├── UseCases/
│   │   │   ├── Device/
│   │   │   │   ├── ScanDevicesUseCase.swift        # 扫描设备用例
│   │   │   │   ├── ConnectDeviceUseCase.swift      # 连接设备用例
│   │   │   │   └── DisconnectDeviceUseCase.swift   # 断开连接用例
│   │   │   │
│   │   │   ├── DSPControl/
│   │   │   │   ├── UpdateDSPParameterUseCase.swift # 更新 DSP 参数用例
│   │   │   │   ├── ReadDSPStateUseCase.swift       # 读取 DSP 状态用例
│   │   │   │   └── ResetDSPUseCase.swift           # 重置 DSP 用例
│   │   │   │
│   │   │   ├── RoomCorrection/
│   │   │   │   ├── StartMeasurementUseCase.swift   # 开始测量用例
│   │   │   │   ├── AnalyzeRoomUseCase.swift        # 分析房间用例
│   │   │   │   └── ApplyCorrectionsUseCase.swift   # 应用校准用例
│   │   │   │
│   │   │   └── Preset/
│   │   │       ├── SavePresetUseCase.swift         # 保存预设用例
│   │   │       ├── LoadPresetUseCase.swift         # 加载预设用例
│   │   │       └── DeletePresetUseCase.swift       # 删除预设用例
│   │   │
│   │   └── Repositories/
│   │       ├── DeviceRepositoryProtocol.swift      # 设备仓储协议
│   │       ├── PresetRepositoryProtocol.swift      # 预设仓储协议
│   │       └── MeasurementRepositoryProtocol.swift # 测量仓储协议
│   │

### │   ├── Presentation/

│   │   ├── ViewModels/
│   │   │   ├── DeviceScanViewModel.swift           # 设备扫描 VM
│   │   │   ├── DeviceConnectionViewModel.swift     # 设备连接 VM
│   │   │   ├── MainControlViewModel.swift          # 主控制面板 VM
│   │   │   ├── EqualizerViewModel.swift            # 均衡器 VM
│   │   │   ├── CrossoverViewModel.swift            # 分频器 VM
│   │   │   ├── RoomCorrectionViewModel.swift       # 房间校准 VM
│   │   │   ├── MeasurementViewModel.swift          # 测量 VM
│   │   │   ├── PresetViewModel.swift               # 预设 VM
│   │   │   └── SettingsViewModel.swift             # 设置 VM
│   │   │
│   │   ├── Views/
│   │   │   ├── DeviceConnection/
│   │   │   │   ├── DeviceScanView.swift            # 设备扫描视图
│   │   │   │   ├── DeviceListView.swift            # 设备列表视图
│   │   │   │   └── DeviceDetailView.swift          # 设备详情视图
│   │   │   │
│   │   │   ├── MainControl/
│   │   │   │   ├── MainControlView.swift           # 主控制面板
│   │   │   │   ├── QuickControlView.swift          # 快速控制
│   │   │   │   └── StatusBarView.swift             # 状态栏
│   │   │   │
│   │   │   ├── DSPControl/
│   │   │   │   ├── EqualizerView.swift             # 均衡器视图
│   │   │   │   ├── CrossoverView.swift             # 分频器视图
│   │   │   │   ├── PhaseControlView.swift          # 相位控制视图
│   │   │   │   ├── GainControlView.swift           # 增益控制视图
│   │   │   │   ├── LimiterView.swift               # 限制器视图
│   │   │   │   └── DynamicBassView.swift           # 动态低音视图
│   │   │   │
│   │   │   ├── RoomCorrection/
│   │   │   │   ├── RoomCorrectionView.swift        # 房间校准主视图
│   │   │   │   ├── MeasurementWizardView.swift     # 测量向导
│   │   │   │   ├── FrequencyResponseView.swift     # 频率响应视图
│   │   │   │   ├── SPLMeterView.swift              # 声压计视图
│   │   │   │   └── RecommendationView.swift        # 推荐参数视图
│   │   │   │
│   │   │   ├── Visualization/
│   │   │   │   ├── AudioCurveView.swift            # 音频曲线视图
│   │   │   │   ├── InteractiveCurveEditor.swift    # 交互式曲线编辑器
│   │   │   │   ├── FrequencySpectrumView.swift     # 频谱视图
│   │   │   │   ├── RealTimeAnalyzerView.swift      # 实时分析器视图
│   │   │   │   └── WaterfallView.swift             # 瀑布图视图
│   │   │   │
│   │   │   ├── Preset/
│   │   │   │   ├── PresetListView.swift            # 预设列表
│   │   │   │   ├── PresetDetailView.swift          # 预设详情
│   │   │   │   └── PresetEditorView.swift          # 预设编辑器
│   │   │   │
│   │   │   └── Settings/
│   │   │       ├── SettingsView.swift              # 设置主视图
│   │   │       ├── DeviceSettingsView.swift        # 设备设置
│   │   │       ├── AudioSettingsView.swift         # 音频设置
│   │   │       ├── AboutView.swift                 # 关于页面
│   │   │       └── AdvancedSettingsView.swift      # 高级设置
│   │   │
│   │   └── Components/
│   │       ├── Controls/
│   │       │   ├── CustomSlider.swift              # 自定义滑块
│   │       │   ├── KnobControl.swift               # 旋钮控件
│   │       │   ├── SegmentedControl.swift          # 分段控件
│   │       │   └── ToggleSwitch.swift              # 切换开关
│   │       │
│   │       ├── Charts/
│   │       │   ├── LineChartView.swift             # 折线图
│   │       │   ├── BarChartView.swift              # 柱状图
│   │       │   └── WaveformView.swift              # 波形图
│   │       │
│   │       └── Common/
│   │           ├── LoadingView.swift               # 加载视图
│   │           ├── EmptyStateView.swift            # 空状态视图
│   │           ├── ErrorView.swift                 # 错误视图
│   │           └── ToastView.swift                 # 提示视图
│   │

### │   ├── Infrastructure/

│   │   ├── Bluetooth/
│   │   │   ├── CoreBluetoothAdapter.swift          # CoreBluetooth 适配器
│   │   │   ├── BLECharacteristicManager.swift      # BLE 特征管理
│   │   │   └── BLEServiceDefinitions.swift         # BLE 服务定义
│   │   │
│   │   ├── Audio/
│   │   │   ├── AVAudioEngineAdapter.swift          # AVAudioEngine 适配器
│   │   │   ├── AudioSessionManager.swift           # 音频会话管理
│   │   │   └── AudioBufferProcessor.swift          # 音频缓冲处理
│   │   │
│   │   ├── Persistence/
│   │   │   ├── CoreDataStack.swift                 # Core Data 栈
│   │   │   ├── UserDefaultsManager.swift           # UserDefaults 管理
│   │   │   └── FileManager+Extensions.swift        # 文件管理扩展
│   │   │
│   │   └── Network/
│   │       └── FirmwareUpdateManager.swift         # 固件更新管理（如需要）
│   │

### │   ├── Utilities/

│   │   ├── Extensions/
│   │   │   ├── Color+Extensions.swift              # 颜色扩展
│   │   │   ├── View+Extensions.swift               # 视图扩展
│   │   │   ├── Data+Extensions.swift               # 数据扩展
│   │   │   ├── Double+Extensions.swift             # 数字扩展
│   │   │   └── Array+Extensions.swift              # 数组扩展
│   │   │
│   │   ├── Helpers/
│   │   │   ├── MathHelpers.swift                   # 数学辅助函数
│   │   │   ├── AudioHelpers.swift                  # 音频辅助函数
│   │   │   ├── DateFormatter+Shared.swift          # 日期格式化
│   │   │   └── UnitConverter.swift                 # 单位转换
│   │   │
│   │   ├── Constants/
│   │   │   ├── AppConstants.swift                  # 应用常量
│   │   │   ├── AudioConstants.swift                # 音频常量
│   │   │   ├── BluetoothConstants.swift            # 蓝牙常量
│   │   │   └── UIConstants.swift                   # UI 常量
│   │   │
│   │   └── Logger/
│   │       ├── Logger.swift                        # 日志工具
│   │       └── LogLevel.swift                      # 日志级别
│   │

### │   ├── Resources/

│   │   ├── Assets.xcassets/                        # 图片资源
│   │   │   ├── AppIcon.appiconset/
│   │   │   ├── Colors/
│   │   │   └── Images/
│   │   │
│   │   ├── Fonts/                                  # 字体文件
│   │   ├── Sounds/                                 # 声音文件
│   │   │
│   │   └── Localization/
│   │       ├── en.lproj/
│   │       │   └── Localizable.strings             # 英文本地化
│   │       └── zh-Hans.lproj/
│   │           └── Localizable.strings             # 简体中文本地化
│   │

### │   └── Configuration/

│       ├── Info.plist                              # 应用配置
│       ├── Debug.xcconfig                          # Debug 配置
│       └── Release.xcconfig                        # Release 配置
│

## ├── Tests/

### │   ├── UnitTests/

│   │   ├── DSPControllerTests.swift                # DSP 控制器测试
│   │   ├── AudioAnalyzerTests.swift                # 音频分析器测试
│   │   ├── BluetoothManagerTests.swift             # 蓝牙管理器测试
│   │   └── RoomCorrectionTests.swift               # 房间校准测试
│   │
│   └── UITests/
│       ├── DeviceScanUITests.swift                 # 设备扫描 UI 测试
│       ├── MainControlUITests.swift                # 主控制 UI 测试
│       └── RoomCorrectionUITests.swift             # 房间校准 UI 测试
│

## ├── Packages/                                       # Swift Packages (可选)

│   └── DSPCore/                                    # 自定义 DSP 核心包
│

## ├── Documentation/

│   ├── Architecture.md                             # 架构文档
│   ├── BluetoothProtocol.md                        # 蓝牙协议文档
│   └── DSPCommands.md                              # DSP 命令文档
│

## └── README.md                                       # 项目说明



1️⃣ App/ - 应用入口
iWooferProApp.swift: SwiftUI App 入口，配置依赖注入
AppDelegate.swift: 处理应用生命周期事件
2️⃣ Core/ - 核心业务逻辑
Bluetooth/: 蓝牙扫描、连接、通信协议
DSP/: DSP 参数控制、命令构建、滤波器实现
Audio/: 音频采集、FFT 分析、声压计
RoomCorrection/: 房间声学分析、自动校准算法
Storage/: 数据持久化、预设管理
3️⃣ Domain/ - 领域层
Models/: 业务模型（设备、音频、DSP 设置、预设）
UseCases/: 用例（业务逻辑封装）
Repositories/: 仓储协议（数据访问抽象）
4️⃣ Presentation/ - 表现层
ViewModels/: MVVM 的 ViewModel 层
Views/: SwiftUI 视图
Components/: 可复用 UI 组件
5️⃣ Infrastructure/ - 基础设施层
对外部框架的适配（CoreBluetooth, AVFoundation, Core Data）
6️⃣ Utilities/ - 工具类
扩展、辅助函数、常量、日志



---

## 📚 推荐学习资源

1. **音频 DSP**:
   - 《The Audio Programming Book》
   - Apple's Audio Unit Programming Guide

2. **蓝牙开发**:
   - Apple's Core Bluetooth Programming Guide
   - Nordic Semiconductor 的 BLE 教程

3. **房间声学校准**:
   - 学术论文：Room Equalization Using FIR Filters
   - 开源项目：REW (Room EQ Wizard)